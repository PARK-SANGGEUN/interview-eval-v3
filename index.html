<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>모두의 1:1 대입 면접 평가 v4.5 (All Teachers Edition)</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
:root {
  --main: #f97316;
  --navy: #0f172a;
  --border: #d4d4d8;
  --bg: #f9fafb;
  --card: #fff;
  --A: #16a34a; --B: #06b6d4; --C: #facc15; --D: #fb923c; --E: #ef4444;
}
*{box-sizing:border-box}
body {
  font-family: "Pretendard Variable", sans-serif;
  background: var(--bg);
  margin: 0;
  color: #1e293b;
}
header {
  background: var(--navy);
  color: white;
  text-align: center;
  padding: 2rem 1rem 1.2rem;
  border-bottom: 4px solid var(--main);
}
header h1 { margin: 0; font-size: 1.8rem; }
header p { margin: .5rem 0 0; color: #cbd5e1; }
header .sub { color:#cbd5e1;font-size:.9rem;margin-top:6px; }

main { max-width: 980px; margin: 2rem auto; padding: 0 1rem; }

.card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  margin-bottom: 1.2rem;
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
}
.card h2 {
  background: #f1f5f9;
  border-bottom: 1px solid var(--border);
  padding: .9rem 1.2rem;
  font-size: 1.05rem;
  margin: 0;
}
.card .content { padding: 1rem 1.5rem; }

.info-grid {
  display: grid;
  grid-template-columns: 120px 1fr 120px 1fr;
  gap: 12px;
}
label {
  font-weight: 600;
  align-self: center;
}
.input {
  width: 100%;
  padding: 8px 10px;
  border: 1px solid #cbd5e1;
  border-radius: 8px;
  font-size: .95rem;
}
.input:focus { outline: 2px solid var(--main); }

.note {
  background: #fff8f1;
  border-left: 6px solid var(--main);
  padding: 1.2rem 1rem;
  border-radius: 8px;
  margin: 1.5rem 0;
  color: #475569;
  font-size: .95rem;
}

table {
  width: 100%;
  border-collapse: collapse;
  font-size: .9rem;
  margin-top: .6rem;
}
th, td {
  border: 1px solid var(--border);
  padding: .8rem;
  text-align: center;
}
th {
  background: #f9fafb;
  font-weight: 600;
}
td.grade {
  cursor: pointer;
  transition: all 0.2s;
}
td.grade:hover {
  background: #fff7ed;
}
.selected-A { background: #dcfce7; border:2px solid var(--A); }
.selected-B { background: #cffafe; border:2px solid var(--B); }
.selected-C { background: #fef9c3; border:2px solid var(--C); }
.selected-D { background: #ffedd5; border:2px solid var(--D); }
.selected-E { background: #fee2e2; border:2px solid var(--E); }

.textarea {
  width: 100%;
  height: 120px;
  border: 1px solid #cbd5e1;
  border-radius: 8px;
  padding: 10px;
  margin-top: 8px;
}
select {
  width: 100%;
  padding: 8px;
  border: 1px solid #cbd5e1;
  border-radius: 8px;
  margin-top: 8px;
}

button {
  background: var(--main);
  color: white;
  border: none;
  border-radius: 10px;
  padding: 12px 18px;
  font-size: 1rem;
  cursor: pointer;
}
button:hover {
  background: #ea580c;
}
footer {
  text-align: center;
  color: #64748b;
  margin: 2rem 0;
  font-size: .9rem;
}
</style>
</head>
<body>
<header>
  <h1>모두의 1:1 대입 면접 평가 v4.5</h1>
  <p>All Teachers — 학생별 루브릭 기반 피드백 시스템</p>
  <p class="sub">Copyright@All Teachers (피드백 p3412@nate.com)</p>
</header>

<main id="capture">
  <div class="note">
    <b>📘 사용 안내</b><br>
    이 시스템은 <b>정성 중심형 1:1 면접 피드백</b>을 위한 교사용 도구입니다.<br>
    각 항목의 등급(A~E)을 클릭하면 해당 루브릭이 표시되고, 코멘트를 선택하면 피드백 칸에 자동으로 입력됩니다.<br>
    여러 코멘트를 누르면 모두 누적 입력되며, 직접 수정도 가능합니다.<br>
    [💾 PDF 저장] 버튼을 누르면 입력된 모든 내용을 자동으로 캡처하여 한글이 깨지지 않는 PDF로 저장됩니다.
  </div>

  <section class="card">
    <h2>기본 정보</h2>
    <div class="content info-grid">
      <label>학생 이름</label><input id="name" class="input" placeholder="예: 김민서">
      <label>대학</label><input id="univ" class="input" placeholder="예: 경희대학교">
      <label>학과</label><input id="major" class="input" placeholder="예: 물리학과">
      <label>차시</label><input id="session" class="input" placeholder="예: 2차 면접">
    </div>
  </section>

  <div id="rubrics"></div>

  <section class="card">
    <h2>⑥ 종합 피드백</h2>
    <div class="content">
      <select id="summarySelect" onchange="addComment(this, 'summary')">
        <option>코멘트 선택</option>
        <option>면접 태도와 논리적 사고가 뛰어나며, 진정성 있는 답변을 제시함.</option>
        <option>질문 의도를 잘 파악하고 핵심에 맞는 답변을 구성함.</option>
        <option>자신의 경험을 구체적으로 설명하며 학업 의지를 보여줌.</option>
        <option>표현이 명확하고 설득력이 있음.</option>
        <option>학업과 진로 간의 연계가 자연스럽고 구체적임.</option>
        <option>전공 적합성이 충분히 드러남.</option>
        <option>탐구력과 사고력이 전반적으로 우수함.</option>
        <option>면접 전반에서 성장 가능성이 높게 평가됨.</option>
        <option>성실하고 차분한 태도로 좋은 인상을 줌.</option>
        <option>표현 및 소통에서 자신감을 유지함.</option>
      </select>
      <textarea id="summary" class="textarea" placeholder="종합 피드백 입력 또는 수정 가능"></textarea>
    </div>
  </section>

  <div style="text-align:center;margin-top:20px;">
    <button id="pdfBtn">💾 PDF 저장</button>
  </div>
</main>

<footer>
  Copyright@All Teachers (피드백 p3412@nate.com)
</footer>

<script>
const rubricData = [
  {
    title:"① 표현 및 소통능력",
    criteria:"질문 이해도, 논리 구성, 면접 태도",
    levels:{A:"질문 의도를 정확히 파악하고 논리적으로 표현함",B:"대체로 명확하나 일부 논리적 비약 존재",C:"기본 수준의 소통 가능",D:"표현이 다소 불분명함",E:"소통 및 이해 어려움"},
    comments:["자신감 있고 명료한 어조로 논리적 답변을 제시함.","질문 요지를 정확히 파악하며 핵심을 잘 짚음.","표현이 자연스럽고 전달력이 뛰어남.","말의 속도와 어투가 안정적이고 신뢰감을 줌.","예의 바르고 면접 태도가 성숙함.","일부 표현이 반복되지만 내용은 정확함.","의견 전달은 명확하나 근거 제시가 부족함.","내용은 충실하나 표현이 단조로움.","답변 중 약간의 긴장감이 있었으나 회복이 빠름.","소통 의지는 뚜렷하나 논리 연결이 다소 부족함."]
  },
  {
    title:"② 전공적합성",
    criteria:"전공 이해도, 관련 경험 및 진로 동기",
    levels:{A:"전공 이해도와 경험이 우수",B:"전공 관심은 뚜렷하나 구체성 부족",C:"관심은 있으나 경험 제한적",D:"전공 동기 불명확",E:"전공과 무관한 답변"},
    comments:["전공 관련 탐구 경험이 풍부하고 동기가 명확함.","진로 목표와 학문적 흥미가 자연스럽게 연결됨.","전공 교과 학습 경험이 깊고 실제 사례를 언급함.","관련 분야의 탐구 활동을 구체적으로 제시함.","진로 계획이 실현 가능하고 일관성이 있음.","관심은 높으나 구체적인 사례 부족.","탐구 활동의 깊이가 다소 부족함.","연결성은 있으나 표현이 모호함.","지식의 폭은 있으나 전공 관련 경험이 부족함.","진로 방향은 있으나 근거가 불충분함."]
  }
];

// 루브릭 생성
window.onload = () => {
  const container = document.getElementById("rubrics");
  rubricData.forEach((r,idx)=>{
    let rows = Object.entries(r.levels)
      .map(([grade,desc])=>`<tr><td class="grade" onclick="selectGrade(this)">${grade}</td><td>${desc}</td></tr>`)
      .join("");
    const comments = r.comments.map(c=>`<option>${c}</option>`).join("");
    container.innerHTML += `
    <section class="card">
      <h2>${r.title}</h2>
      <div class="content">
        <b>세부 기준:</b> ${r.criteria}
        <table>${rows}</table>
        <select onchange="addComment(this,'fb${idx}')">
          <option>코멘트 선택</option>${comments}
        </select>
        <textarea id="fb${idx}" class="textarea" placeholder="피드백 입력 또는 수정 가능"></textarea>
      </div>
    </section>`;
  });
};

// 등급 선택
function selectGrade(td){
  const row = td.parentElement.parentElement.querySelectorAll(".grade");
  row.forEach(c=>c.className="grade");
  td.classList.add("selected-"+td.innerText);
}

// 코멘트 추가
function addComment(sel, id){
  if(sel.value){
    const ta = document.getElementById(id);
    ta.value += (ta.value ? "\n" : "") + sel.value;
    sel.value = "";
  }
}

// PDF 캡처 저장 (전체 페이지 포함)
document.getElementById("pdfBtn").addEventListener("click", async ()=>{
  const { jsPDF } = window.jspdf;
  const element = document.getElementById("capture");
  const canvas = await html2canvas(element,{scale:2,scrollY:0});
  const imgData = canvas.toDataURL("image/png");
  const pdf = new jsPDF("p","mm","a4");
  const pageWidth = 210;
  const pageHeight = 297;
  const imgHeight = canvas.height * pageWidth / canvas.width;
  let heightLeft = imgHeight;
  let position = 0;

  pdf.addImage(imgData, "PNG", 0, position, pageWidth, imgHeight);
  heightLeft -= pageHeight;

  while (heightLeft > 0) {
    position = heightLeft - imgHeight;
    pdf.addPage();
    pdf.addImage(imgData, "PNG", 0, position, pageWidth, imgHeight);
    heightLeft -= pageHeight;
  }
  pdf.save(`${document.getElementById("name").value||"학생"}_면접평가.pdf`);
});
</script>
</body>
</html>
