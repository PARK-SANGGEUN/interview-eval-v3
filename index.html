<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>모두의 1:1 대입 면접 평가 v4.6 (All Teachers Edition)</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
:root {
  --main:#f97316; --navy:#0f172a; --border:#d4d4d8; --bg:#f9fafb;
  --A:#16a34a; --B:#06b6d4; --C:#facc15; --D:#fb923c; --E:#ef4444;
}
body{font-family:"Pretendard Variable",sans-serif;background:var(--bg);margin:0;color:#1e293b;}
header{background:var(--navy);color:#fff;text-align:center;padding:2rem 1rem 1.2rem;border-bottom:4px solid var(--main);}
header h1{margin:0;font-size:1.8rem;}
header p{margin:.5rem 0 0;color:#cbd5e1;}
header .sub{color:#cbd5e1;font-size:.9rem;margin-top:6px;}
main{max-width:980px;margin:2rem auto;padding:0 1rem;}
.card{background:#fff;border:1px solid var(--border);border-radius:12px;margin-bottom:1.2rem;box-shadow:0 2px 6px rgba(0,0,0,.05);}
.card h2{background:#f1f5f9;border-bottom:1px solid var(--border);padding:.9rem 1.2rem;font-size:1.05rem;margin:0;}
.card .content{padding:1rem 1.5rem;}
.info-grid{display:grid;grid-template-columns:120px 1fr 120px 1fr;gap:12px;}
label{font-weight:600;align-self:center;}
.input{width:100%;padding:8px 10px;border:1px solid #cbd5e1;border-radius:8px;font-size:.95rem;}
.input:focus{outline:2px solid var(--main);}
.note{background:#fff8f1;border-left:6px solid var(--main);padding:1.2rem 1rem;border-radius:8px;margin:1.5rem 0;color:#475569;font-size:.95rem;}
table{width:100%;border-collapse:collapse;font-size:.9rem;margin-top:.6rem;}
th,td{border:1px solid var(--border);padding:.6rem;text-align:center;}
th{background:#f9fafb;font-weight:600;}
td.grade{cursor:pointer;transition:all .2s;}
td.grade:hover{background:#fff7ed;}
.selected-A{background:#dcfce7;border:2px solid var(--A);}
.selected-B{background:#cffafe;border:2px solid var(--B);}
.selected-C{background:#fef9c3;border:2px solid var(--C);}
.selected-D{background:#ffedd5;border:2px solid var(--D);}
.selected-E{background:#fee2e2;border:2px solid var(--E);}
.textarea{width:100%;height:120px;border:1px solid #cbd5e1;border-radius:8px;padding:10px;margin-top:8px;}
select{width:100%;padding:8px;border:1px solid #cbd5e1;border-radius:8px;margin-top:8px;}
button{background:var(--main);color:#fff;border:none;border-radius:10px;padding:12px 18px;font-size:1rem;cursor:pointer;}
button:hover{background:#ea580c;}
footer{text-align:center;color:#64748b;margin:2rem 0;font-size:.9rem;}
</style>
</head>
<body>
<header>
  <h1>모두의 1:1 대입 면접 평가 v4.6</h1>
  <p>All Teachers — 학생별 루브릭 기반 피드백 시스템</p>
  <p class="sub">Copyright@All Teachers (피드백 p3412@nate.com)</p>
</header>

<main id="capture">
  <div class="note">
    <b>📘 사용 안내</b><br>
    이 시스템은 <b>정성 중심형 1:1 면접 피드백</b>을 위한 교사용 평가 도구입니다.<br>
    각 항목의 등급(A~E)을 클릭하면 색상과 루브릭 설명이 표시되며, 코멘트를 선택하면 피드백 칸에 자동 입력됩니다.<br>
    여러 코멘트를 누르면 누적 입력되며, 직접 수정도 가능합니다.<br>
    [💾 PDF 저장] 버튼을 누르면 모든 입력 내용이 한글 깨짐 없이 전체 페이지로 저장됩니다.
  </div>

  <section class="card">
    <h2>기본 정보</h2>
    <div class="content info-grid">
      <label>학생 이름</label><input id="name" class="input" placeholder="예: 김민서">
      <label>대학</label><input id="univ" class="input" placeholder="예: 경희대학교">
      <label>학과</label><input id="major" class="input" placeholder="예: 물리학과">
      <label>차시</label><input id="session" class="input" placeholder="예: 2차 면접">
    </div>
  </section>

  <div id="rubrics"></div>

  <section class="card">
    <h2>⑥ 종합 피드백</h2>
    <div class="content">
      <select id="summarySelect" onchange="addComment(this, 'summary')">
        <option>코멘트 선택</option>
        <option>면접 태도와 논리적 사고가 뛰어나며 진정성 있는 답변을 제시함.</option>
        <option>질문 의도를 잘 파악하고 핵심에 맞는 답변을 구성함.</option>
        <option>자신의 경험을 구체적으로 설명하며 학업 의지를 보여줌.</option>
        <option>표현이 명확하고 설득력이 있음.</option>
        <option>학업과 진로 간의 연계가 자연스럽고 구체적임.</option>
        <option>전공 적합성이 충분히 드러남.</option>
        <option>탐구력과 사고력이 전반적으로 우수함.</option>
        <option>면접 전반에서 성장 가능성이 높게 평가됨.</option>
        <option>성실하고 차분한 태도로 좋은 인상을 줌.</option>
        <option>표현 및 소통에서 자신감을 유지함.</option>
      </select>
      <textarea id="summary" class="textarea" placeholder="종합 피드백 입력 또는 수정 가능"></textarea>
    </div>
  </section>

  <div style="text-align:center;margin-top:20px;">
    <button id="pdfBtn">💾 PDF 저장</button>
  </div>
</main>

<footer>Copyright@All Teachers (피드백 p3412@nate.com)</footer>

<script>
const rubricData = [
  {title:"① 표현 및 소통능력",criteria:"논리 구성, 말의 명료성, 태도",levels:{A:"논리적이며 명료하게 의사소통함",B:"대체로 명확하나 일부 비약 존재",C:"기본적인 소통 가능",D:"표현이 다소 불명확함",E:"소통에 어려움 있음"},comments:["자신감 있고 명료한 어조로 답변함.","질문 의도를 잘 파악함.","표현이 자연스럽고 전달력이 뛰어남.","면접 태도가 안정적임."]},
  {title:"② 전공적합성",criteria:"전공 이해도, 관련 경험",levels:{A:"전공 이해도 우수",B:"관심 뚜렷하나 구체성 부족",C:"경험 제한적",D:"동기 불명확",E:"무관한 답변"},comments:["전공 탐구 경험이 풍부함.","진로 목표가 명확함.","관련 사례를 구체적으로 제시함."]},
  {title:"③ 학업역량",criteria:"교과 관련 지식, 탐구 태도",levels:{A:"학업 성취 우수",B:"기초지식 충실",C:"평균적 이해도",D:"기초 부족",E:"학습 의지 부족"},comments:["기초 개념이 잘 정립되어 있음.","문제 해결력이 우수함.","학습 태도가 성실함."]},
  {title:"④ 인성 및 태도",criteria:"예의, 성실성, 책임감",levels:{A:"예의 바르고 성실함",B:"성실하나 다소 긴장함",C:"태도 보통",D:"소극적",E:"무성의한 태도"},comments:["예의와 배려가 돋보임.","책임감 있는 태도를 보임.","긍정적 태도로 응답함."]},
  {title:"⑤ 사고력",criteria:"문제 해결, 창의적 사고",levels:{A:"창의적 사고 우수",B:"논리적 사고 가능",C:"기초적 사고 가능",D:"단순 암기식 답변",E:"사고력 부족"},comments:["핵심을 분석하고 논리 전개함.","문제 해결 방식이 체계적임.","유연한 사고력을 보임."]},
  {title:"⑥ 발전가능성",criteria:"자기성찰, 성장의지",levels:{A:"성장 가능성 매우 높음",B:"발전 의지 뚜렷함",C:"평균적 수준",D:"노력 부족",E:"성찰 부족"},comments:["자기주도적 학습 태도 우수.","목표의식이 분명함.","꾸준한 성장 의지를 보임."]}
];

// 루브릭 생성
window.onload=()=>{
  const container=document.getElementById("rubrics");
  rubricData.forEach((r,idx)=>{
    let rows=Object.entries(r.levels).map(([grade,desc])=>`
      <tr>
        <td class="grade" onclick="selectGrade(this)">${grade}</td>
        <td>${desc}</td>
      </tr>`).join("");
    const comments=r.comments.map(c=>`<option>${c}</option>`).join("");
    container.innerHTML+=`
    <section class="card">
      <h2>${r.title}</h2>
      <div class="content">
        <b>세부 기준:</b> ${r.criteria}
        <table>${rows}</table>
        <select onchange="addComment(this,'fb${idx}')">
          <option>코멘트 선택</option>${comments}
        </select>
        <textarea id="fb${idx}" class="textarea" placeholder="피드백 입력 또는 수정 가능"></textarea>
      </div>
    </section>`;
  });
};

// 등급 선택 기능
function selectGrade(td){
  const table=td.closest("table");
  table.querySelectorAll(".grade").forEach(cell=>cell.className="grade");
  td.classList.add("selected-"+td.innerText);
}

// 코멘트 누적 입력 기능 (모든 영역 공통)
function addComment(sel,id){
  if(sel.value){
    const t=document.getElementById(id);
    t.value+=(t.value?'\n':'')+sel.value;
    sel.value="";
  }
}

// PDF 저장 전체화면 캡처 (스크롤 포함)
document.getElementById("pdfBtn").addEventListener("click",async()=>{
  const {jsPDF}=window.jspdf;
  const element=document.getElementById("capture");
  const canvas=await html2canvas(element,{scale:2,useCORS:true,scrollY:-window.scrollY,windowWidth:document.body.scrollWidth,windowHeight:document.body.scrollHeight});
  const imgData=canvas.toDataURL("image/png");
  const pdf=new jsPDF("p","mm","a4");
  const pageWidth=210;
  const pageHeight=297;
  const imgHeight=canvas.height*pageWidth/canvas.width;
  let heightLeft=imgHeight;
  let position=0;
  pdf.addImage(imgData,"PNG",0,position,pageWidth,imgHeight);
  heightLeft-=pageHeight;
  while(heightLeft>0){
    position=heightLeft-imgHeight;
    pdf.addPage();
    pdf.addImage(imgData,"PNG",0,position,pageWidth,imgHeight);
    heightLeft-=pageHeight;
  }
  pdf.save(`${document.getElementById("name").value||"면접"}_평가.pdf`);
});
</script>
</body>
</html>
