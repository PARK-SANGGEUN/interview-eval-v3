<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>모두의 1:1 대입 면접 평가 v4.1 (All Teachers Edition)</title>

<!-- Pretendard Font -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable.css">

<style>
:root {
  --main-color: #f97316;
  --bg-color: #f9fafc;
  --border-color: #e2e8f0;
  --card-bg: #ffffff;
  --header-bg: #1e293b;
}
body {
  font-family: 'Pretendard Variable', sans-serif;
  background: var(--bg-color);
  margin: 0;
  color: #1e293b;
  line-height: 1.5;
}

/* HEADER */
header {
  background: var(--header-bg);
  color: #fff;
  text-align: center;
  padding: 2rem 1rem;
  border-bottom: 4px solid var(--main-color);
}
header h1 {
  font-size: 1.9rem;
  margin: 0;
}
header p {
  margin-top: 0.4rem;
  font-size: 1rem;
  opacity: 0.9;
}

/* MAIN LAYOUT */
main {
  max-width: 960px;
  margin: 2rem auto;
  padding: 1rem;
}

/* CARD BOX */
.card {
  background: var(--card-bg);
  border: 1px solid var(--border-color);
  border-radius: 12px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.05);
  margin-bottom: 1.5rem;
  transition: all .3s ease;
}
.card:hover {
  box-shadow: 0 5px 12px rgba(0,0,0,0.08);
}
.card h2 {
  margin: 0;
  padding: 1rem;
  font-size: 1.1rem;
  background: #f1f5f9;
  border-bottom: 1px solid var(--border-color);
  cursor: pointer;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.card-content {
  padding: 1rem 1.5rem;
}

/* INPUTS */
label {
  display: inline-block;
  font-weight: 600;
  margin-top: 0.5rem;
  width: 80px;
}
input[type="text"] {
  padding: 0.6rem;
  border: 1px solid #cbd5e1;
  border-radius: 6px;
  width: calc(40% - 10px);
  margin-right: 0.8rem;
  font-size: 0.95rem;
}
input[type="text"]:focus {
  outline: 2px solid var(--main-color);
}
@media(max-width:768px){
  input[type="text"] {
    width: 100%;
    margin-bottom: 0.6rem;
  }
}

/* 안내문 */
.note {
  background: #fff8f1;
  border-left: 5px solid var(--main-color);
  padding: 1.2rem;
  border-radius: 8px;
  margin: 1.5rem 0;
  color: #475569;
  font-size: 0.95rem;
}

/* 버튼 */
button {
  background: var(--main-color);
  color: #fff;
  border: none;
  border-radius: 8px;
  padding: 0.9rem 1.3rem;
  font-size: 1rem;
  margin-top: 1rem;
  cursor: pointer;
  transition: all .2s ease;
}
button:hover {
  background: #ea580c;
}

/* TABLES */
table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.9rem;
  margin-top: 0.8rem;
}
th, td {
  border: 1px solid var(--border-color);
  padding: 0.7rem;
  text-align: center;
}

/* FOOTER */
footer {
  text-align: center;
  font-size: 0.85rem;
  color: #64748b;
  margin-top: 2.5rem;
  padding-bottom: 2rem;
}
</style>
</head>

<body>
<header>
  <h1>모두의 1:1 대입 면접 평가 v4.1</h1>
  <p>All Teachers — 학생별 루브릭 기반 피드백 시스템</p>
</header>

<main>
  <!-- 기본 정보 -->
  <div class="card">
    <h2>기본 정보</h2>
    <div class="card-content">
      <label>학생 이름</label><input type="text" id="studentName" placeholder="예: 김민서">
      <label>대학</label><input type="text" id="university" placeholder="예: 경희대학교"><br>
      <label>학과</label><input type="text" id="major" placeholder="예: 물리학과">
      <label>차시</label><input type="text" id="session" placeholder="예: 2차 면접">
    </div>
  </div>

  <!-- 사용 안내 -->
  <div class="note">
    ⚙️ <b>사용 안내</b><br>
    각 항목의 세부 기준을 클릭하면 A~E 등급별 루브릭 문구가 나타납니다.<br>
    코멘트를 선택하면 피드백 칸에 자동 입력되며, 여러 개 선택 및 수정이 가능합니다.<br>
    모든 입력 내용은 자동 저장되며, <b>[💾 PDF 저장]</b> 버튼으로 파일을 내려받아 공유할 수 있습니다.
  </div>

  <!-- 루브릭 항목 출력 영역 -->
  <div id="rubrics"></div>

  <!-- 종합 피드백 -->
  <div class="card">
    <h2>⑥ 종합 피드백</h2>
    <div class="card-content">
      <textarea id="summary" style="width:100%;height:120px;border:1px solid #cbd5e1;border-radius:6px;padding:.6rem;font-size:.95rem;" placeholder="종합 피드백 입력 또는 수정 가능"></textarea>
    </div>
  </div>

  <div style="text-align:center;">
    <button id="saveBtn">💾 PDF 저장</button>
  </div>
</main>

<footer>
  Copyright@All Teachers (피드백 p3412@nate.com)
</footer>

<!-- 다음 메시지에서 2부 (루브릭+코멘트+PDF기능) 붙임 -->
</body>
</html>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
// ===============================
// 루브릭 데이터 (5개 영역 × A~E 문구)
// ===============================
const rubricData = [
  {
    id: 1,
    title: "① 표현 및 소통능력",
    criteria: "말의 명료성, 논리 구성, 면접 태도",
    levels: {
      A: "질문 의도를 정확히 파악하고 논리적으로 표현함",
      B: "대부분 명확하나 약간의 논리적 비약 존재",
      C: "기본 수준의 소통 가능",
      D: "표현이 다소 불분명함",
      E: "소통 및 이해 어려움"
    },
    comments: [
      "자신감 있고 자연스러운 말투로 전달함.",
      "내용이 일관되며 표현이 명확함.",
      "논리 전개가 자연스럽고 핵심이 잘 드러남.",
      "표현력이 우수하며 청자의 이해를 돕는 설명이 좋음.",
      "목소리 톤과 속도가 안정적임.",
      "표현은 명확하나 어투가 다소 경직됨.",
      "내용은 알맞으나 예시가 부족함.",
      "긴장감이 있으나 성실히 답변함.",
      "전달력이 다소 약하지만 진정성이 있음.",
      "답변 의도는 좋으나 문장 구성의 완성도가 낮음."
    ]
  },
  {
    id: 2,
    title: "② 전공적합성",
    criteria: "전공 관련 경험, 진로 동기",
    levels: {
      A: "전공 이해도와 관련 경험이 우수함",
      B: "전공 관심 뚜렷하나 일부 구체성 부족",
      C: "관심은 있으나 경험 제한적",
      D: "전공 동기 불명확",
      E: "전공과 무관한 답변"
    },
    comments: [
      "전공 관련 경험과 이해도가 매우 높음.",
      "관련 과목 학습 경험이 구체적으로 드러남.",
      "진로 동기가 뚜렷하며 일관성 있는 답변.",
      "전공 선택의 이유를 논리적으로 설명함.",
      "해당 전공의 특징을 잘 이해하고 있음.",
      "관심은 있으나 사례 제시가 부족함.",
      "이해도는 있으나 깊이 있는 접근이 필요함.",
      "연결성은 보이지만 구체성이 약함.",
      "전공 관련성은 있으나 표현이 미흡함.",
      "진로 동기가 다소 모호하게 제시됨."
    ]
  },
  {
    id: 3,
    title: "③ 탐구력",
    criteria: "논리적 사고, 문제 해결력, 지적 호기심",
    levels: {
      A: "문제를 깊이 분석하고 창의적 대안을 제시함",
      B: "논리적이고 적절한 분석이 가능함",
      C: "기본 수준의 사고 가능",
      D: "논리 구조 불분명",
      E: "사고력·이해력 부족"
    },
    comments: [
      "논리적 사고와 문제 해결 과정이 명확함.",
      "비판적 사고를 통해 타당한 근거를 제시함.",
      "새로운 관점에서 질문을 분석함.",
      "탐구 과정이 체계적이며 구체적임.",
      "창의적인 아이디어를 적극 제시함.",
      "논리 전개는 좋으나 예시 부족.",
      "탐구력은 있으나 표현력이 부족함.",
      "분석은 있으나 결론 도출이 약함.",
      "호기심은 있으나 깊이 부족.",
      "논리 연결이 다소 불분명함."
    ]
  },
  {
    id: 4,
    title: "④ 인성",
    criteria: "협업, 배려, 책임감",
    levels: {
      A: "성실하고 타인을 존중하며 협력 태도 우수",
      B: "예의 바르고 성실함",
      C: "일반적인 태도 유지",
      D: "다소 소극적 태도",
      E: "무성의하거나 예의 부족"
    },
    comments: [
      "타인을 존중하고 예의 바른 태도를 보임.",
      "협동심과 책임감이 잘 드러남.",
      "성실하고 겸손한 자세로 임함.",
      "공감 능력이 뛰어남.",
      "배려와 존중이 자연스럽게 표현됨.",
      "태도는 좋으나 표현이 경직됨.",
      "성실하나 적극성이 부족함.",
      "자신감이 다소 낮은 모습.",
      "책임감은 있으나 소통이 부족함.",
      "예의는 있으나 자기주장이 약함."
    ]
  },
  {
    id: 5,
    title: "⑤ 성장 가능성",
    criteria: "자기 성찰, 발전 의지, 계획",
    levels: {
      A: "자기 이해도 높고 구체적 계획 제시",
      B: "성찰과 목표의식 있음",
      C: "발전 의지는 있으나 구체성 부족",
      D: "자기인식 약함",
      E: "성찰 부족"
    },
    comments: [
      "자기 이해와 발전 의지가 뚜렷함.",
      "실패 경험을 성찰하고 개선 방안을 제시함.",
      "목표 의식이 뚜렷하며 구체적 계획이 있음.",
      "도전정신과 꾸준한 성실함이 돋보임.",
      "자기 주도적 학습 태도를 보임.",
      "성찰은 있으나 구체성 부족.",
      "의지는 있으나 실행력이 부족함.",
      "목표는 있으나 방향이 모호함.",
      "자기 이해가 다소 부족함.",
      "발전 가능성은 있으나 표현이 약함."
    ]
  }
];

// ===============================
// 화면 생성
// ===============================
window.onload = () => {
  const container = document.getElementById("rubrics");
  rubricData.forEach(r => {
    const levelCells = Object.entries(r.levels).map(([grade, text]) =>
      `<td onclick="selectGrade(this, ${r.id}, '${grade}')" title="${text}">${grade}</td>`
    ).join("");
    const commentOptions = r.comments.map(c => `<option>${c}</option>`).join("");
    container.innerHTML += `
      <div class="card">
        <h2 onclick="toggleCard(this)">${r.title} ▼</h2>
        <div class="card-content">
          <table>
            <tr><th>세부 기준</th><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th></tr>
            <tr><td>${r.criteria}</td>${levelCells}</tr>
          </table>
          <select class="comment-select" onchange="addComment(this, ${r.id})">
            <option value="">코멘트 선택</option>${commentOptions}
          </select>
          <textarea id="feedback${r.id}" style="width:100%;height:100px;border:1px solid #cbd5e1;border-radius:6px;padding:.6rem;margin-top:.6rem;" placeholder="피드백 입력 또는 수정 가능"></textarea>
        </div>
      </div>`;
  });
  loadFromStorage();
};

// ===============================
// 카드 접기/펼치기
// ===============================
function toggleCard(h) {
  const content = h.nextElementSibling;
  content.style.display = content.style.display === "block" ? "none" : "block";
}

// ===============================
// 등급 선택 색상 표시
// ===============================
function selectGrade(cell, id, grade) {
  const row = cell.parentNode;
  row.querySelectorAll("td").forEach(td => td.classList.remove("selected"));
  cell.classList.add("selected");
  saveToStorage();
}

// ===============================
// 코멘트 선택 시 자동 추가
// ===============================
function addComment(sel, id) {
  if (sel.value) {
    const fb = document.getElementById(`feedback${id}`);
    fb.value += (fb.value ? "\n" : "") + sel.value;
    sel.value = "";
    saveToStorage();
  }
}

// ===============================
// 자동 저장 / 불러오기 (LocalStorage)
// ===============================
function saveToStorage() {
  const data = {
    studentName: studentName.value,
    university: university.value,
    major: major.value,
    session: session.value,
    summary: summary.value
  };
  rubricData.forEach(r => {
    data[`feedback${r.id}`] = document.getElementById(`feedback${r.id}`).value;
  });
  localStorage.setItem("interviewFeedback", JSON.stringify(data));
}
function loadFromStorage() {
  const data = JSON.parse(localStorage.getItem("interviewFeedback") || "{}");
  if (!data) return;
  studentName.value = data.studentName || "";
  university.value = data.university || "";
  major.value = data.major || "";
  session.value = data.session || "";
  summary.value = data.summary || "";
  rubricData.forEach(r => {
    document.getElementById(`feedback${r.id}`).value = data[`feedback${r.id}`] || "";
  });
}

// ===============================
// PDF 저장 (한글 폰트 깨짐 방지)
// ===============================
async function savePDF() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF({ orientation: "p", unit: "mm", format: "a4" });

  // NanumGothic 폰트 로드
  const fontUrl = "https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2001@1.3/NanumGothic-Regular.woff";
  const font = await fetch(fontUrl).then(res => res.arrayBuffer());
  const fontBase64 = btoa(String.fromCharCode(...new Uint8Array(font)));
  doc.addFileToVFS("NanumGothic.ttf", fontBase64);
  doc.addFont("NanumGothic.ttf", "NanumGothic", "normal");
  doc.setFont("NanumGothic");

  let y = 20;
  doc.setFontSize(14);
  doc.text("모두의 1:1 대입 면접 평가 (All Teachers Edition)", 20, y);
  y += 10;

  const n = studentName.value || "학생", u = university.value || "대학", m = major.value || "학과", s = session.value || "면접";
  doc.setFontSize(11);
  doc.text(`학생: ${n}   대학: ${u}   학과: ${m}   차시: ${s}`, 20, y);
  y += 10;

  rubricData.forEach(r => {
    const fb = document.getElementById(`feedback${r.id}`).value;
    if (fb) {
      const lines = doc.splitTextToSize(`${r.title}: ${fb}`, 170);
      doc.text(lines, 20, y);
      y += lines.length * 6 + 4;
    }
  });
  if (summary.value) {
    const lines = doc.splitTextToSize(`종합 피드백: ${summary.value}`, 170);
    doc.text(lines, 20, y);
  }

  doc.save(`${n}-${u}-${m}-면접피드백-${s}.pdf`);
}
document.getElementById("saveBtn").addEventListener("click", savePDF);
</script>

