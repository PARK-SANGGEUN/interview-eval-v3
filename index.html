<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>모두의 1:1 대입 면접 평가 v4.2 (All Teachers Edition)</title>

<!-- Pretendard Font -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable.css" />

<style>
:root {
  --main-color: #f97316;
  --bg-color: #f8fafc;
  --header-bg: #1e293b;
  --border-color: #e2e8f0;
}
body {
  font-family: "Pretendard Variable", sans-serif;
  margin: 0;
  background: var(--bg-color);
  color: #1e293b;
}

/* HEADER */
header {
  background: var(--header-bg);
  color: white;
  text-align: center;
  padding: 2rem 1rem 1.5rem;
  border-bottom: 4px solid var(--main-color);
}
header h1 {
  margin: 0;
  font-size: 1.9rem;
}
header p {
  margin: 0.5rem 0 0;
  font-size: 1rem;
  color: #cbd5e1;
}

/* MAIN */
main {
  max-width: 960px;
  margin: 2rem auto;
  padding: 0 1rem;
}

/* 카드형 */
.card {
  background: white;
  border: 1px solid var(--border-color);
  border-radius: 12px;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
  margin-bottom: 1.5rem;
}
.card h2 {
  font-size: 1.1rem;
  background: #f1f5f9;
  padding: 1rem;
  margin: 0;
  border-bottom: 1px solid var(--border-color);
  cursor: pointer;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.card-content {
  padding: 1rem 1.5rem;
}

/* INPUT */
label {
  display: inline-block;
  font-weight: 600;
  width: 90px;
}
input[type="text"] {
  border: 1px solid #cbd5e1;
  border-radius: 6px;
  padding: 0.6rem;
  width: calc(40% - 10px);
  margin: 0.4rem 0.8rem 0.4rem 0;
  font-size: 0.95rem;
}
input[type="text"]:focus {
  outline: 2px solid var(--main-color);
}
@media (max-width: 768px) {
  input[type="text"] {
    width: 100%;
  }
  label {
    width: 100%;
  }
}

/* 안내문 */
.note {
  background: #fff8f1;
  border-left: 5px solid var(--main-color);
  border-radius: 8px;
  padding: 1.2rem;
  font-size: 0.95rem;
  margin: 1.5rem 0;
  color: #475569;
}

/* 테이블 */
table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.9rem;
  margin-top: 0.8rem;
}
th, td {
  border: 1px solid var(--border-color);
  padding: 0.7rem;
  text-align: center;
}
td.selected {
  background: #fed7aa;
  font-weight: bold;
}

/* 피드백 입력 */
textarea {
  width: 100%;
  height: 100px;
  border: 1px solid #cbd5e1;
  border-radius: 6px;
  padding: 0.6rem;
  font-size: 0.95rem;
  margin-top: 0.6rem;
}

/* 버튼 */
button {
  background: var(--main-color);
  color: #fff;
  border: none;
  border-radius: 8px;
  padding: 0.9rem 1.3rem;
  font-size: 1rem;
  cursor: pointer;
  margin-top: 1rem;
}
button:hover {
  background: #ea580c;
}

/* FOOTER */
footer {
  text-align: center;
  color: #64748b;
  font-size: 0.9rem;
  margin: 2rem 0;
}
</style>
</head>
<body>
<header>
  <h1>모두의 1:1 대입 면접 평가 v4.2</h1>
  <p>All Teachers — 학생별 루브릭 기반 피드백 시스템</p>
</header>

<main>
  <!-- 기본정보 -->
  <div class="card">
    <h2>기본 정보</h2>
    <div class="card-content">
      <label>학생 이름</label><input type="text" id="studentName" placeholder="예: 김민서" />
      <label>대학</label><input type="text" id="university" placeholder="예: 경희대학교" /><br />
      <label>학과</label><input type="text" id="major" placeholder="예: 물리학과" />
      <label>차시</label><input type="text" id="session" placeholder="예: 2차 면접" />
    </div>
  </div>

  <!-- 안내 -->
  <div class="note">
    ⚙️ <b>사용 안내</b><br />
    각 항목의 등급(A~E)을 클릭하면 색상이 반영되고 루브릭 설명이 표시됩니다.<br />
    코멘트를 선택하면 피드백 칸에 자동 입력되며 여러 개 선택 및 수정이 가능합니다.<br />
    모든 입력 내용은 자동 저장되며, <b>[💾 PDF 저장]</b> 버튼으로 직접 저장해 공유하세요.
  </div>

  <div id="rubrics"></div>

  <!-- 종합 피드백 -->
  <div class="card">
    <h2>⑥ 종합 피드백</h2>
    <div class="card-content">
      <textarea id="summary" placeholder="종합 피드백 입력 또는 수정 가능"></textarea>
    </div>
  </div>

  <div style="text-align: center">
    <button id="saveBtn">💾 PDF 저장</button>
  </div>
</main>

<footer>
  Copyright@All Teachers (피드백 p3412@nate.com)
</footer>

<!-- JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
const rubricData = [
  {
    id: 1, title: "① 표현 및 소통능력", criteria: "말의 명료성, 논리 구성, 면접 태도",
    levels: {A:"의도 파악 및 논리적 표현 우수",B:"표현 명확하나 약간 비약 존재",C:"기본 소통 가능",D:"표현 불분명",E:"이해 어려움"},
    comments: ["자신감 있고 자연스러운 말투.","논리적 전개가 명확함.","표현이 구체적이며 핵심을 잘 전달함.","목소리 안정적.","예의 바른 태도 유지.","표현은 명확하나 완성도 부족.","긴장감 있으나 진정성 있음.","말의 일관성 유지.","논리 흐름이 약간 불분명.","전달력은 있으나 어휘 부족."]
  },
  {
    id: 2, title: "② 전공적합성", criteria: "전공 관련 경험, 진로 동기",
    levels: {A:"전공 이해도 높음",B:"전공 관심 뚜렷하나 구체성 부족",C:"관심 있으나 경험 제한적",D:"동기 불명확",E:"무관한 답변"},
    comments: ["전공 관련 경험 풍부.","학문적 이해도가 높음.","진로 동기가 분명함.","과목 연계성 설명 우수.","탐구활동 구체적 언급.","관심은 있으나 사례 부족.","내용 구체성 약함.","연결성 미흡.","전공 관련 지식 부족.","동기 설명 모호."]
  },
  {
    id: 3, title: "③ 탐구력", criteria: "논리적 사고, 문제해결, 지적 호기심",
    levels: {A:"문제 분석 및 창의적 대안 제시",B:"논리적 분석 우수",C:"기본 사고 가능",D:"논리 불명확",E:"이해력 부족"},
    comments: ["논리적 사고 우수.","탐구과정 체계적.","문제 분석력 뛰어남.","창의적 아이디어 제시.","비판적 사고력 탁월.","논리 전개 약함.","탐구 의도는 좋으나 표현 부족.","사고 깊이 부족.","호기심은 있으나 연결 약함.","결론 미흡."]
  },
  {
    id: 4, title: "④ 인성", criteria: "협업, 배려, 책임감",
    levels: {A:"협력 태도 우수",B:"성실하고 예의 바름",C:"일반적 태도 유지",D:"소극적 태도",E:"무성의함"},
    comments: ["협동심이 돋보임.","타인 존중 태도.","책임감 강함.","예의 바름.","성실한 자세.","배려 표현 좋음.","소극적 태도.","협력은 있으나 적극성 부족.","자기중심적 답변.","무성의한 응답."]
  },
  {
    id: 5, title: "⑤ 성장 가능성", criteria: "자기성찰, 발전의지, 계획",
    levels: {A:"자기이해 높고 구체적 계획 제시",B:"성찰 및 목표의식 있음",C:"발전 의지는 있으나 구체성 부족",D:"자기인식 약함",E:"성찰 부족"},
    comments: ["목표의식 분명.","자기이해도 높음.","성찰적 태도.","발전 계획 구체적.","꾸준한 학습 의지.","의지는 있으나 실행 부족.","목표 불명확.","성찰은 있으나 구체성 부족.","자기이해 부족.","발전 가능성 약함."]
  }
];

// 생성
window.onload = () => {
  const container = document.getElementById("rubrics");
  rubricData.forEach(r => {
    const levels = Object.entries(r.levels).map(([g,t])=>`<td onclick="selectGrade(this)" title="${t}">${g}</td>`).join("");
    const opts = r.comments.map(c=>`<option>${c}</option>`).join("");
    container.innerHTML += `
      <div class="card">
        <h2>${r.title}</h2>
        <div class="card-content">
          <table>
            <tr><th>세부 기준</th><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th></tr>
            <tr><td>${r.criteria}</td>${levels}</tr>
          </table>
          <select onchange="addComment(this,${r.id})"><option>코멘트 선택</option>${opts}</select>
          <textarea id="feedback${r.id}" placeholder="피드백 입력 또는 수정 가능"></textarea>
        </div>
      </div>`;
  });
  loadData();
};

// 코멘트 추가
function addComment(sel,id){
  if(sel.value){
    const box=document.getElementById("feedback"+id);
    box.value+=(box.value?"\n":"")+sel.value;
    sel.value="";saveData();
  }
}

// 등급선택
function selectGrade(td){
  td.parentNode.querySelectorAll("td").forEach(x=>x.classList.remove("selected"));
  td.classList.add("selected");saveData();
}

// 저장
function saveData(){
  const d={studentName:studentName.value,university:university.value,major:major.value,session:session.value,summary:summary.value};
  rubricData.forEach(r=>d["feedback"+r.id]=document.getElementById("feedback"+r.id).value);
  localStorage.setItem("feedbackForm",JSON.stringify(d));
}
function loadData(){
  const d=JSON.parse(localStorage.getItem("feedbackForm")||"{}");
  studentName.value=d.studentName||"";university.value=d.university||"";major.value=d.major||"";session.value=d.session||"";summary.value=d.summary||"";
  rubricData.forEach(r=>{document.getElementById("feedback"+r.id).value=d["feedback"+r.id]||""});
}

// PDF 저장
document.getElementById("saveBtn").addEventListener("click",async()=>{
  const {jsPDF}=window.jspdf;
  const doc=new jsPDF();
  const font=await fetch("https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2001@1.3/NanumGothic-Regular.woff").then(r=>r.arrayBuffer());
  const base64=btoa(String.fromCharCode(...new Uint8Array(font)));
  doc.addFileToVFS("NanumGothic.ttf",base64);
  doc.addFont("NanumGothic.ttf","NanumGothic","normal");
  doc.setFont("NanumGothic");
  doc.setFontSize(12);
  let y=20;
  doc.text(`모두의 1:1 대입 면접 평가 (All Teachers Edition)`,20,y);y+=10;
  doc.text(`학생:${studentName.value||""} / 대학:${university.value||""} / 학과:${major.value||""} / 차시:${session.value||""}`,20,y);y+=10;
  rubricData.forEach(r=>{
    const text=document.getElementById("feedback"+r.id).value;
    if(text){doc.text(r.title,20,y);y+=6;const lines=doc.splitTextToSize(text,170);doc.text(lines,20,y);y+=lines.length*6+4;}
  });
  const s=summary.value;if(s){doc.text("종합 피드백",20,y);y+=6;const lines=doc.splitTextToSize(s,170);doc.text(lines,20,y);}
  doc.save(`${studentName.value||"학생"}-${university.value||"대학"}-${major.value||"학과"}-면접피드백-${session.value||""}.pdf`);
});
</script>
</body>
</html>
