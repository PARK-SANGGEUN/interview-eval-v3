<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>모두의 1:1 대입 면접 평가 v4.0 (All Teachers)</title>

<!-- Pretendard Font -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable.css">

<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body {
  font-family:'Pretendard Variable',sans-serif;
  background:#f9fafc;
  margin:0;
  color:#1e293b;
}
header {
  background:#1e293b;
  color:white;
  text-align:center;
  padding:2rem 1rem;
}
header h1 {
  margin:0;
  font-size:1.9rem;
}
header p {
  margin:.5rem 0 0;
  font-size:1rem;
  opacity:0.9;
}
main {
  max-width:960px;
  margin:2rem auto;
  padding:1rem;
}
.card {
  background:#fff;
  border:1px solid #e2e8f0;
  border-radius:12px;
  box-shadow:0 2px 8px rgba(0,0,0,0.05);
  margin-bottom:1.3rem;
  transition:all .3s ease;
}
.card:hover {
  box-shadow:0 4px 10px rgba(0,0,0,0.08);
}
.card h2 {
  margin:0;
  padding:1rem;
  background:#f1f5f9;
  border-bottom:1px solid #e2e8f0;
  font-size:1.05rem;
  cursor:pointer;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.card-content {
  display:none;
  padding:1rem;
  animation:fadein .3s ease;
}
@keyframes fadein {
  from {opacity:0;transform:translateY(-5px);}
  to {opacity:1;transform:translateY(0);}
}
.note {
  background:#fff8f1;
  border-left:4px solid #f97316;
  padding:1rem;
  border-radius:6px;
  margin-bottom:1.5rem;
  color:#475569;
}
label {
  display:inline-block;
  width:90px;
  font-weight:600;
  margin-top:.6rem;
}
input[type=text] {
  padding:.6rem;
  border:1px solid #cbd5e1;
  border-radius:6px;
  width:40%;
  margin-right:.8rem;
}
input:focus {
  outline:2px solid #f97316;
}
.comment-select {
  width:100%;
  margin-top:.5rem;
  padding:.6rem;
  border:1px solid #cbd5e1;
  border-radius:6px;
}
.feedback-box {
  width:100%;
  height:100px;
  border:1px solid #cbd5e1;
  border-radius:6px;
  padding:.6rem;
  margin-top:.8rem;
  font-size:.95rem;
  background:#f9fafb;
}
.feedback-box:focus {
  outline:2px solid #f97316;
  background:#fff;
}
button {
  background:#f97316;
  color:#fff;
  border:none;
  border-radius:8px;
  padding:.9rem 1.3rem;
  font-size:1rem;
  margin-top:1rem;
  cursor:pointer;
  transition:all .2s ease;
}
button:hover {
  background:#ea580c;
}
.grade-A {background:#dcfce7!important;}
.grade-B {background:#e0f2fe!important;}
.grade-C {background:#fef9c3!important;}
.grade-D {background:#ffedd5!important;}
.grade-E {background:#fee2e2!important;}
.selected {
  font-weight:600;
  border:2px solid #f97316;
}
table {
  width:100%;
  border-collapse:collapse;
  font-size:.9rem;
  margin-top:.4rem;
}
th, td {
  border:1px solid #e2e8f0;
  padding:.6rem;
  text-align:center;
  cursor:pointer;
}
footer {
  text-align:center;
  font-size:0.85rem;
  color:#64748b;
  margin-top:2rem;
  padding-bottom:2rem;
}
@media(max-width:768px){
  input[type=text]{width:90%;margin-bottom:.5rem;}
}
</style>
</head>

<body>
<header>
  <h1>모두의 1:1 대입 면접 평가 v4.0</h1>
  <p>All Teachers — 학생별 루브릭 기반 피드백 시스템</p>
</header>

<main>
  <div class="card">
    <h2>기본 정보</h2>
    <div class="card-content" style="display:block;">
      <label>학생 이름</label><input type="text" id="studentName" placeholder="예: 김민서">
      <label>대학</label><input type="text" id="university" placeholder="예: 경희대학교"><br>
      <label>학과</label><input type="text" id="major" placeholder="예: 물리학과">
      <label>차시</label><input type="text" id="session" placeholder="예: 2차 면접">
    </div>
  </div>

  <div class="note">
    💬 <b>사용 안내</b><br>
    각 항목의 등급(A~E)을 클릭하면 색상이 반영되고, 코멘트를 선택하면 피드백 칸에 자동 입력됩니다.<br>
    여러 코멘트를 선택하거나 직접 수정할 수 있으며, [💾 PDF 저장]으로 내려받아 직접 공유하세요.<br>
    모든 입력 내용은 자동 저장되어 새로고침 후에도 유지됩니다.
  </div>

  <div id="rubrics"></div>

  <div class="card">
    <h2 onclick="toggleCard(this)">⑥ 종합 피드백 ▼</h2>
    <div class="card-content">
      <select class="comment-select" id="summarySelect" onchange="addSummaryComment(this)">
        <option value="">코멘트 선택</option>
        <option>면접 태도가 성실하며 발전 가능성이 높음.</option>
        <option>논리적 답변 구성이 우수하며 전공 이해도가 깊음.</option>
        <option>표현력과 태도 모두 긍정적으로 평가됨.</option>
        <option>답변의 일관성과 자기 성찰이 돋보임.</option>
        <option>자신감 있는 태도와 명확한 사고가 돋보임.</option>
        <option>꾸준한 연습을 통해 더욱 안정된 면접이 기대됨.</option>
        <option>내용 이해는 좋으나 긴장감이 약간 보임.</option>
        <option>면접 태도는 우수하나 세부 근거 제시가 부족함.</option>
        <option>진정성 있는 태도로 성실히 임함.</option>
        <option>면접 준비가 체계적이며 발전 가능성이 매우 큼.</option>
      </select>
      <textarea id="summary" class="feedback-box" placeholder="종합 피드백 입력 또는 수정 가능"></textarea>
    </div>
  </div>

  <div style="text-align:center;">
    <button onclick="savePDF()">💾 PDF 저장</button>
  </div>
</main>

<footer>
  Copyright@All Teachers (피드백 p3412@nate.com)
</footer>
<script>
// ==========================
// 1. 루브릭 데이터 정의
// ==========================
const rubricData = [
  {id:1,title:'① 표현 및 소통능력',criteria:'말의 명료성, 논리 구성, 태도',levels:{A:'우수',B:'양호',C:'보통',D:'미흡',E:'부족'},
  comments:[
    "질문 의도를 명확히 파악하고 논리적으로 답변함.",
    "자신감 있고 자연스러운 말투로 전달함.",
    "내용이 일관되며 표현이 명확함.",
    "어휘 선택이 풍부하고 전달력이 좋음.",
    "말의 속도와 시선처리가 안정적임.",
    "논리 전개는 좋으나 결론이 약함.",
    "핵심을 짚어 말하지만 일부 반복이 있음.",
    "표현은 명확하나 어투가 다소 경직됨.",
    "긴장감이 있으나 성실히 답변함.",
    "전달력이 다소 약하지만 진정성이 있음."
  ]},
  {id:2,title:'② 전공적합성',criteria:'전공 관련 경험과 이해도',levels:{A:'우수',B:'양호',C:'보통',D:'미흡',E:'부족'},
  comments:[
    "전공 관련 지식과 관심이 뚜렷하게 드러남.",
    "관련 경험을 구체적으로 설명함.",
    "진로 동기가 명확하며 일관된 답변을 보임.",
    "전공 선택의 이유가 논리적임.",
    "관련 과목 학습 경험이 잘 드러남.",
    "관심은 있으나 사례가 다소 부족함.",
    "이해도는 있으나 깊이가 더 필요함.",
    "전공 연결성이 불분명함.",
    "관심 표현은 있으나 근거 제시가 약함.",
    "답변이 구체성 부족으로 모호함."
  ]},
  {id:3,title:'③ 탐구력',criteria:'논리적 사고, 문제 해결, 호기심',levels:{A:'우수',B:'양호',C:'보통',D:'미흡',E:'부족'},
  comments:[
    "논리적 사고와 문제 해결 과정이 명확함.",
    "사실을 분석하고 이유를 제시함.",
    "비판적 사고를 바탕으로 근거를 제시함.",
    "새로운 관점으로 문제를 접근함.",
    "질문에 대해 분석적 사고가 돋보임.",
    "논리 구조는 있으나 예시가 부족함.",
    "의견은 있으나 구체적 근거 부족.",
    "호기심은 있으나 탐구 깊이가 얕음.",
    "표면적 답변에 머무름.",
    "논리 연결이 다소 불분명함."
  ]},
  {id:4,title:'④ 인성',criteria:'협력, 배려, 책임감',levels:{A:'우수',B:'양호',C:'보통',D:'미흡',E:'부족'},
  comments:[
    "타인을 존중하고 예의 바른 태도를 보임.",
    "성실하고 겸손한 자세로 임함.",
    "협동심과 책임감이 잘 드러남.",
    "공감 능력이 우수함.",
    "배려와 존중이 자연스럽게 표현됨.",
    "태도는 좋으나 표현이 다소 경직됨.",
    "성실하나 적극성은 부족함.",
    "자신감이 낮아 소극적인 인상.",
    "책임감은 있으나 소통이 부족함.",
    "예의는 있으나 자기주장이 약함."
  ]},
  {id:5,title:'⑤ 성장 가능성',criteria:'자기 성찰, 발전 의지, 계획',levels:{A:'우수',B:'양호',C:'보통',D:'미흡',E:'부족'},
  comments:[
    "자기 이해와 발전 의지가 뚜렷함.",
    "실패 경험을 성찰하고 개선 방안을 제시함.",
    "목표 의식이 뚜렷하며 구체적 계획이 있음.",
    "도전정신과 성실함이 돋보임.",
    "꾸준한 자기계발 노력이 보임.",
    "성찰은 있으나 구체성이 부족함.",
    "의지는 있으나 실행력 부족.",
    "목표는 있으나 방향이 모호함.",
    "자기 이해가 다소 부족함.",
    "발전 가능성이 있으나 표현이 약함."
  ]}
];

// ==========================
// 2. 카드 및 루브릭 생성
// ==========================
window.onload = () => {
  const container = document.getElementById('rubrics');
  rubricData.forEach(r => {
    const tableCells = Object.keys(r.levels).map(g =>
      `<td onclick="selectGrade(this,${r.id},'${g}')">${g}</td>`
    ).join('');
    const commentOptions = r.comments.map(c => `<option>${c}</option>`).join('');
    container.innerHTML += `
      <div class="card">
        <h2 onclick="toggleCard(this)">${r.title} ▼</h2>
        <div class="card-content">
          <table>
            <tr><th>세부 기준</th><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th></tr>
            <tr><td>${r.criteria}</td>${tableCells}</tr>
          </table>
          <select class="comment-select" onchange="addComment(this,${r.id})">
            <option value="">코멘트 선택</option>${commentOptions}
          </select>
          <textarea id="feedback${r.id}" class="feedback-box" placeholder="피드백 입력 또는 수정 가능"></textarea>
        </div>
      </div>`;
  });

  loadFromStorage();
};

// ==========================
// 3. 카드 토글
// ==========================
function toggleCard(h){
  const content = h.nextElementSibling;
  content.style.display = content.style.display === 'block' ? 'none' : 'block';
}

// ==========================
// 4. 등급 선택
// ==========================
function selectGrade(cell, idx, grade){
  let row = cell.parentNode;
  row.querySelectorAll('td').forEach(td => td.classList.remove('selected','grade-A','grade-B','grade-C','grade-D','grade-E'));
  cell.classList.add('selected','grade-'+grade);
  saveToStorage();
}

// ==========================
// 5. 코멘트 추가
// ==========================
function addComment(sel, id){
  if(sel.value){
    let fb = document.getElementById('feedback'+id);
    fb.value += (fb.value ? '\n' : '') + sel.value;
    sel.value = '';
    saveToStorage();
  }
}
function addSummaryComment(sel){
  if(sel.value){
    let fb = document.getElementById('summary');
    fb.value += (fb.value ? '\n' : '') + sel.value;
    sel.value = '';
    saveToStorage();
  }
}

// ==========================
// 6. 자동 저장 (LocalStorage)
// ==========================
function saveToStorage(){
  const data = {
    studentName: studentName.value,
    university: university.value,
    major: major.value,
    session: session.value,
    summary: summary.value
  };
  rubricData.forEach(r=>{
    data['feedback'+r.id] = document.getElementById('feedback'+r.id).value;
  });
  localStorage.setItem('interviewFeedback', JSON.stringify(data));
}
function loadFromStorage(){
  const data = JSON.parse(localStorage.getItem('interviewFeedback') || '{}');
  if(!data) return;
  studentName.value = data.studentName || '';
  university.value = data.university || '';
  major.value = data.major || '';
  session.value = data.session || '';
  summary.value = data.summary || '';
  rubricData.forEach(r=>{
    document.getElementById('feedback'+r.id).value = data['feedback'+r.id] || '';
  });
}

// ==========================
// 7. PDF 저장 (NanumGothic 포함)
// ==========================
async function savePDF(){
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF({orientation:'p',unit:'mm',format:'a4'});
  
  // NanumGothic 폰트 내장
  const fontUrl = "https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2001@1.3/NanumGothic-Regular.woff";
  const font = await fetch(fontUrl).then(res => res.arrayBuffer());
  const fontBase64 = btoa(
    String.fromCharCode(...new Uint8Array(font))
  );
  doc.addFileToVFS("NanumGothic.ttf", fontBase64);
  doc.addFont("NanumGothic.ttf", "NanumGothic", "normal");
  doc.setFont("NanumGothic");
  
  let y=20;
  doc.setFontSize(14);
  doc.text("모두의 1:1 대입 면접 평가 (All Teachers)",20,y);
  y+=10;
  doc.setFontSize(11);
  const n = studentName.value||'학생', u = university.value||'대학', m = major.value||'학과', s = session.value||'면접';
  doc.text(`학생: ${n}   대학: ${u}   학과: ${m}   차시: ${s}`,20,y);
  y+=10;

  rubricData.forEach(r=>{
    const fb = document.getElementById('feedback'+r.id).value;
    if(fb){
      const lines = doc.splitTextToSize(`${r.title}: ${fb}`,170);
      doc.text(lines,20,y);
      y += lines.length*6 + 4;
    }
  });
  if(summary.value){
    const lines = doc.splitTextToSize(`종합 피드백: ${summary.value}`,170);
    doc.text(lines,20,y);
  }
  doc.save(`${n}-${u}-${m}-면접피드백-${s}.pdf`);
}
</script>
</body>
</html>

